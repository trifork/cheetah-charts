on: [push]

env:
  DEVOPS_DIR: cheetah-charts-test

jobs:
  print-from-script:
    runs-on: ubuntu-latest

    steps:
      - name: Check-out devops repository
        uses: actions/checkout@v2
        with:
          repository: kasttrifork/cheetah-charts-test
          token: ${{ secrets.GITHUB_TOKEN }}
          path: ${{ env.DEVOPS_DIR }}

      - name: Check latest
        id: python
        run: |
          out=$(python ${{ env.DEVOPS_DIR }}/.github/scripts/test.py --name "first time")
          echo "::set-output name=SCRIPT2::${out}"
          echo $out
      - name: print variable
        run: echo 'Prints variable out' ${{ steps.python.outputs.SCRIPT2 }}
      - name: read-yaml 
        id: yaml-data
        uses: jbutcher5/read-yaml@1.6     # You may wish to replace main with a version tag such as '1.6' etc.
        with:
          file: '/cheetah-charts-test/charts/cheetah-application/Chart.yaml'          # File to read from
          key-path: '["version"]' # Access the runs key then the using key and retuns the value.  
          run: echo "cheetah-application-V${{ steps.yaml-data.outputs.data }}
