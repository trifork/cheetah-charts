# cheetah-flink

![Version: 0.1.9](https://img.shields.io/badge/Version-0.1.9-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.0.1](https://img.shields.io/badge/AppVersion-0.0.1-informational?style=flat-square)

A Helm chart for handling Cheetah Data Platform Flink jobs

## Requirements

| Repository                 | Name             | Version |
| -------------------------- | ---------------- | ------- |
| file://../image-automation | image-automation | \*      |

## Values

| Key                                                                  | Type   | Default                                                    | Description                                                                                                                                                                                         |
| -------------------------------------------------------------------- | ------ | ---------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| flink.envVars                                                        | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.flinkProperties."execution.checkpointing.interval"             | string | `"10 minutes"`                                             |                                                                                                                                                                                                     |
| flink.flinkProperties."execution.checkpointing.min-pause"            | string | `"10 minutes"`                                             |                                                                                                                                                                                                     |
| flink.flinkProperties."execution.checkpointing.timeout"              | string | `"5 minutes"`                                              |                                                                                                                                                                                                     |
| flink.flinkProperties."rest.flamegraph.enabled"                      | bool   | `true`                                                     |                                                                                                                                                                                                     |
| flink.flinkProperties."taskmanager.numberOfTaskSlots"                | int    | `1`                                                        |                                                                                                                                                                                                     |
| flink.job.additionalConfigs                                          | object | `{}`                                                       | Any additional configuration passed to the job                                                                                                                                                      |
| flink.job.args                                                       | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.job.className                                                  | string | `""`                                                       |                                                                                                                                                                                                     |
| flink.job.jarFile                                                    | string | `""`                                                       |                                                                                                                                                                                                     |
| flink.job.parallelism                                                | int    | `2`                                                        |                                                                                                                                                                                                     |
| flink.job.podAnnotations."linkerd.io/inject"                         | string | `"disabled"`                                               |                                                                                                                                                                                                     |
| flink.job.podLabels                                                  | object | `{}`                                                       |                                                                                                                                                                                                     |
| flink.job.restartPolicy                                              | string | `"Never"`                                                  |                                                                                                                                                                                                     |
| flink.job.volumeMounts                                               | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.job.volumes                                                    | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.jobManager.accessScope                                         | string | `"Cluster"`                                                |                                                                                                                                                                                                     |
| flink.jobManager.additionalConfigs                                   | object | `{}`                                                       | Any additional configuration passed to the jobmanager                                                                                                                                               |
| flink.jobManager.metrics.enabled                                     | bool   | `true`                                                     |                                                                                                                                                                                                     |
| flink.jobManager.metrics.extraPorts[0].containerPort                 | int    | `9249`                                                     |                                                                                                                                                                                                     |
| flink.jobManager.metrics.extraPorts[0].name                          | string | `"metrics"`                                                |                                                                                                                                                                                                     |
| flink.jobManager.podAnnotations                                      | object | `{}`                                                       |                                                                                                                                                                                                     |
| flink.jobManager.podLabels                                           | object | `{}`                                                       |                                                                                                                                                                                                     |
| flink.jobManager.ports.ui                                            | int    | `8081`                                                     |                                                                                                                                                                                                     |
| flink.jobManager.resources.limits.cpu                                | int    | `5`                                                        |                                                                                                                                                                                                     |
| flink.jobManager.resources.limits.memory                             | string | `"1Gi"`                                                    |                                                                                                                                                                                                     |
| flink.jobManager.resources.requests.cpu                              | string | `"100m"`                                                   |                                                                                                                                                                                                     |
| flink.jobManager.resources.requests.memory                           | string | `"256Mi"`                                                  |                                                                                                                                                                                                     |
| flink.jobManager.volumeMounts                                        | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.jobManager.volumes                                             | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.savepoints.accessKey                                           | string | `"flink-s3"`                                               |                                                                                                                                                                                                     |
| flink.savepoints.enabled                                             | bool   | `true`                                                     |                                                                                                                                                                                                     |
| flink.savepoints.endpoint                                            | string | `"http://minio.minio.svc.cluster.local:9000"`              |                                                                                                                                                                                                     |
| flink.savepoints.generation                                          | int    | `0`                                                        | If the job changes too much, the savepoints of an earlier job cannot be used. The generation is added as a suffix to the savepoints directory, fixing the problem. Ignored if not greater than zero |
| flink.savepoints.secretKey                                           | string | `"Z00PBmpZ2aHXlyjVqAigvK9K8YJgs8KT"`                       |                                                                                                                                                                                                     |
| flink.taskManager.additionalConfigs                                  | object | `{}`                                                       | Any additional configuration passed to the taskmanager                                                                                                                                              |
| flink.taskManager.metrics.enabled                                    | bool   | `true`                                                     |                                                                                                                                                                                                     |
| flink.taskManager.metrics.extraPorts[0].containerPort                | int    | `9249`                                                     |                                                                                                                                                                                                     |
| flink.taskManager.metrics.extraPorts[0].name                         | string | `"metrics"`                                                |                                                                                                                                                                                                     |
| flink.taskManager.metrics.extraPorts[0].protocol                     | string | `"TCP"`                                                    |                                                                                                                                                                                                     |
| flink.taskManager.podAnnotations                                     | object | `{}`                                                       |                                                                                                                                                                                                     |
| flink.taskManager.podLabels                                          | object | `{}`                                                       |                                                                                                                                                                                                     |
| flink.taskManager.replicas                                           | int    | `1`                                                        |                                                                                                                                                                                                     |
| flink.taskManager.resources.limits.cpu                               | int    | `5`                                                        |                                                                                                                                                                                                     |
| flink.taskManager.resources.limits.memory                            | string | `"2Gi"`                                                    |                                                                                                                                                                                                     |
| flink.taskManager.resources.requests.cpu                             | string | `"100m"`                                                   |                                                                                                                                                                                                     |
| flink.taskManager.resources.requests.memory                          | string | `"512Mi"`                                                  |                                                                                                                                                                                                     |
| flink.taskManager.volumeMounts                                       | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.taskManager.volumes                                            | list   | `[]`                                                       |                                                                                                                                                                                                     |
| flink.version                                                        | string | `"1.14.4"`                                                 | Which Flink version to use                                                                                                                                                                          |
| fullnameOverride                                                     | string | `""`                                                       |                                                                                                                                                                                                     |
| global                                                               | object | `{"image":{"repository":""},"imagePullSecrets":[]}`        | Only used to decrease duplicate configuration of this chart, if image-automation is used as a sub chart. Overrides the local values if given                                                        |
| image-automation                                                     | object | `{"enabled":false}`                                        | Settings passed to the image-automation chart Image-automation is not possible when using image-sha as a tagging strategy                                                                           |
| image.pullPolicy                                                     | string | `"IfNotPresent"`                                           |                                                                                                                                                                                                     |
| image.repository                                                     | string | `"flink"`                                                  |                                                                                                                                                                                                     |
| image.sha                                                            | string | `""`                                                       |                                                                                                                                                                                                     |
| image.tag                                                            | string | `"main"`                                                   |                                                                                                                                                                                                     |
| imagePullSecrets                                                     | list   | `[]`                                                       |                                                                                                                                                                                                     |
| ingress.annotations."nginx.ingress.kubernetes.io/force-ssl-redirect" | string | `"true"`                                                   |                                                                                                                                                                                                     |
| ingress.annotations."nginx.ingress.kubernetes.io/ssl-redirect"       | string | `"true"`                                                   |                                                                                                                                                                                                     |
| ingress.certType                                                     | string | `"staging"`                                                |                                                                                                                                                                                                     |
| ingress.enabled                                                      | bool   | `false`                                                    | Whether to expose the Flink UI                                                                                                                                                                      |
| ingress.ingressClassName                                             | string | `"nginx"`                                                  |                                                                                                                                                                                                     |
| monitoring.enabled                                                   | bool   | `false`                                                    |                                                                                                                                                                                                     |
| monitoring.flinkProperties."metrics.reporter.prom.class"             | string | `"org.apache.flink.metrics.prometheus.PrometheusReporter"` |                                                                                                                                                                                                     |
| monitoring.flinkProperties."metrics.reporters"                       | string | `"prom"`                                                   |                                                                                                                                                                                                     |
| monitoring.podMetricsEndpoints[0].port                               | string | `"metrics"`                                                |                                                                                                                                                                                                     |
| monitoring.podMonitorSelectorLabels                                  | object | `{"prometheus":"cluster-metrics"}`                         | set podMonitorSelectorLabels {} if your prometheus-operator is set to collect all podMonitors                                                                                                       |
| monitoring.podTargetLabels[0]                                        | string | `"cluster"`                                                |                                                                                                                                                                                                     |
| monitoring.podTargetLabels[1]                                        | string | `"component"`                                              |                                                                                                                                                                                                     |
| nameOverride                                                         | string | `""`                                                       |                                                                                                                                                                                                     |
| replicaCount                                                         | int    | `1`                                                        |                                                                                                                                                                                                     |
